<!DOCTYPE html>
<html lang="en">
	<head>
		{% load staticfiles %}
		{% load i18n %}

		<script src="{% static 'js/jquery-1.11.2.min.js'%}"></script>
		<script src="{% static 'jSignature/jSignature.min.js'%}"></script>
		<!-- <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script> -->
		<script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="{% static 'WebCodeCam/js/main.js' %}"></script>
		<script type="text/javascript" src="{% static 'WebCodeCam/js/startScanQRCode.js' %}"></script>
		<script type="text/javascript" src="{% static 'WebCodeCam/js/qrcodelib.js' %}"></script>
		<script type="text/javascript" src="{% static 'WebCodeCam/js/WebCodeCam.js' %}"></script>
		<script type="text/javascript" src="{% static 'js/spin.min.js' %}"></script>

		<style>
			.spinner {
			  margin-top: 20px;
			}
			.tasks {
				height: 60px; !important
				    display: block;
				width: 100%;
				/* height: 34px; */
				padding: 6px 12px;
				font-size: 24px;
				line-height: 1.42857143;

				color: #555;
				background-color: #fff;
				background-image: none;
				border: 1px solid #ccc;
				border-radius: 4px;
				-webkit-box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
				box-shadow: inset 0 1px 1px rgba(0,0,0,.075);
				-webkit-transition: border-color ease-in-out .15s,-webkit-box-shadow ease-in-out .15s;
				-o-transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
				transition: border-color ease-in-out .15s,box-shadow ease-in-out .15s;
			}
			#emp-list{
			    text-align: center;
				width: 250px;
				display: inherit;
				font-weight: 600;
				margin: -9px -50% 0px 0px;
				position: absolute;
				left: 50%;
				transform: translate(-50%, -50%);
				background: whitesmoke;

			}
			table > tbody > td {
				margin: 15px 15px 15px 15px;
			}
			#btnForward {
				background: url('/static/imgSmall/buttons/nextPastTasks.png') no-repeat top left;
			}
			#btnBack {
				background: url('/static/imgSmall/buttons/backPastTasks.png') no-repeat top left;
			}
			.btnBackAdv {
				background-size: 100% 100%;
				width: 34px;
				border-radius: 10px;
				height: 34px;
				color: white;
				font-size: 20px;
				margin: auto;
			}
			ul {
				border: 2px solid #ddd;
				margin: 0px auto;
				width: 300px;
				padding-left:0px;
			}

			li {
				cursor: pointer;
				font:bold 24px "Lucida Grande",Arial,Sans-Serif;
				padding: 5px 10px 10px 10px;
				position:relative;
				list-style-type: none;

			}

			li.current, li:hover {
				background-color: #ddd !important;
			}

			li:nth-child(2n+1) {
				background:none repeat scroll 0 0 whiteSmoke;
			}

			li.current span { text-decoration: underline; }

			li div {
				display: inline;
				float: right;
				position: relative;
				top: -5px;
			}

			li div img {
				margin-left: 10px;
			}
			.closeEquip{
			background: url('/static/imgSmall/buttons/esc.png') no-repeat top left;
			background-size: 100% 100%;
			width: 50px;
			height: 50px;
			float: right;
			border: none;
			border-radius: 7px;
			box-shadow: -1px 1px 7px gray;
			margin: 0px;
			padding: 0px;
			}
			.full-size{
				width: 95%; important!
			}
			.btnCreateTeam {
			background: #1F3801 !important;
    background-size: 100% 100%;
    border-radius: 7px;
    border: 1px solid #1F3801 !important;
    box-shadow: 2px 2px 5px gray;
    height: 65px;
    width: 250px;
    color: white;
    margin-bottom: 25px;
    font-size: 25px;
    font-weight: 700;}
		</style>
		<script>
		$(document).ready(function(){
			$('[data-toggle="popover"]').popover();
			<!--var iOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;-->

			<!--if(iOS){-->
				<!--document.querySelector('meta[name=viewport]').setAttribute('content','initial-scale=1.0001, minimum-scale=1.0001, maximum-scale=1.0001, user-scalable=no');-->
			  <!--}-->
		});
		</script>
		<style>
			.errorIcon {
				background: url('/static/imgSmall/errorIcon.png') no-repeat top left !important;
				background-size: 100% 100% !important;
				width: 20px !important;
				height: 20px !important;
				border: none !important;
			}

		</style>
		<script type="text/javascript">
		var action = -1;	//1 = start shift ... 2 = stop shift ... 3 = start break ... 4 = stop break ... 5 = timelog
		var lunch = 0;		//	0 = break ... 1 = lunch
		var employeesTimelog = [];
		var idTimelog;
		var user_id;
		var breaks = 0;
		var id_checked = [];
		var group_checked = [];
		var id_scanned = []; // Reiniatilize this array when create a new group
		var name_scanned = [];
		var teamChecked = -1;
		var arrayNames = [];
		var data_scanned = {};
		var checkboxList = true;
		var arrayTeams = [];
		var idGroup = 0;
		var arrayErrors = [];
		var checked_employees = [];
		var indexQuestions = 0;
		var answers = [];
		var employees = 0;
		var user_id = 0;
		var opts = {
		  lines: 10 // The number of lines to draw
		, length: 15 // The length of each line
		, width: 8 // The line thickness
		, radius: 15 // The radius of the inner circle
		, scale: 1 // Scales overall size of the spinner
		, corners: 1 // Corner roundness (0..1)
		, color: '#000' // #rgb or #rrggbb or array of colors
		, opacity: 0.25 // Opacity of the lines
		, rotate: 0 // The rotation offset
		, direction: 1 // 1: clockwise, -1: counterclockwise
		, speed: 1 // Rounds per second
		, trail: 60 // Afterglow percentage
		, fps: 20 // Frames per second when using setTimeout() as a fallback for CSS
		, zIndex: 2e9 // The z-index (defaults to 2000000000)
		, className: 'spinner' // The CSS class to assign to the spinner
		, top: '50%' // Top position relative to parent
		, left: '50%' // Left position relative to parent
		, shadow: false // Whether to render a shadow
		, hwaccel: false // Whether to use hardware acceleration
		, position: 'absolute' // Element positioning
		}
		var target = document.getElementById('messageTimekeeper');
		var spinner = 0;

		$(document).ready(function() {
			$("#foot").load("{%url 'footer'%}");
			$("#head").load("{%url 'headerDriver'%}");
			$("#signature").jSignature();
			$("#saveSignature").click(function(){

				var attendanceId = $("#attendanceId").val();
				<!--alert(document.getElementById("attendanceId").value);-->
				saveSignature("{{ csrf_token }}", "{% url 'shopSaveSignature' %}", document.getElementById("attendanceId").value);
			});
			if($("ul").has("li").length == 0) {
				  $("ul").html("Please Add Employees");
			}

			$("#getAllEmp").click(function() {
				$('#showTimekeeperModal').modal();
				$("#messageTimekeeper").css("color", "#1F3801");	//green
				$("#messageTimekeeper").html("{% trans 'Select Employees' %}:");
				checkboxList = true;
				getAllEmployees("{{ csrf_token }}", "{% url 'getAllEmployees' %}");
			});
			getEmployeeShifts("{{ csrf_token }}", "{% url 'getEmployeeShifts' %}");

			$("input[name='employeeSelected']").change(function() {
			   if ($("input[id='"+this.id+"']").is(":checked")) {
					user_id = this.value;
					id_checked.push(user_id);
				} else {
				    user_id = this.value;
					index = id_checked.indexOf(user_id);
					id_checked.splice(index, 1);
				}
			});

			addRemove();
		    $('#selectAllEmployee').click(function(event) {
		        if(this.checked) { // check select status
		            $('.checkboxEmployee').each(function() {
		            	if (this.checked != true) {
			                this.checked = true;
			                user_id = this.value;
							id_checked.push(user_id);
						}
		            });
		        }else{
		            $('.checkboxEmployee').each(function() {
		                this.checked = false; //deselect all checkboxes
		                user_id = this.value;
						index = id_checked.indexOf(user_id);
						id_checked.splice(index, 1);
		            });
		        }
		    });

		    $("#divSignNow").click(function(){
				$("#messageTimekeeper").css("color", "#1F3801");
				$("#messageTimekeeper").html("{% trans 'Attendance Checklist' %}");
				<!--alert(document.getElementById("attendanceId").value);-->
				retrieveQuestions("{{ csrf_token }}", "{% url 'getChecklistAttendance' %}", document.getElementById("attendanceId").value);
			});

		    $('html').on('click', function(e) {
		    	if (e.target.className == "errorIcon") {
		    		//show popover
		    	} else {
		    		if (typeof $(e.target).data('original-title') == 'undefined' && !$(e.target).parents().is('.popover.in')) {
    					$('[data-original-title]').popover('hide');
  					}
  				}
			});



			$("#shift").click(function() {
				document.getElementById('employee_pin').value = '';
				document.getElementById('employee_pin2').value = '';
				document.getElementById('code2').value = '';
				$('#showTimekeeperModal').modal();
				$("#messageTimekeeper").css("color", "#1F3801");	//green
				$("#messageTimekeeper").html("{% trans 'Select Employee(s)' %}:");
				checkboxList = true;
				emptyDivs();
				getAllEmployees("{{ csrf_token }}", "{% url 'getAllEmployees' %}");

			});

			$("#clock-in").click(function() {
				$("#messageTimekeeper").css("color", "#1F3801");	//green
				$("#messageTimekeeper").html("{% trans 'Starting Shift' %}...");
				emptyDivs();
				action = 1;
				startShiftGroup("{{ csrf_token }}", "{% url 'startShiftGroup' %}", checked_employees);
			});

			$("#clock-out").click(function() {
				$("#messageTimekeeper").css("color", "#1F3801");	//green
				$("#messageTimekeeper").html("{% trans 'Stopping Shift' %}...");
				emptyDivs();
				action = 2;
				stopShiftGroup("{{ csrf_token }}", "{% url 'stopShiftGroup' %}", checked_employees);
			});

			$("#timelog").click(function() {
				emptyDivs();
				$('#showTimekeeperModal').modal();
				$("#messageTimekeeper").css("color", "#1F3801");	//green
				$("#messageTimekeeper").html("{% trans 'Select an Employee' %}:");
				checkboxList = false;
				getAllEmployees("{{ csrf_token }}", "{% url 'getAllEmployees' %}");
			});


			$("#timelog2").click(function() {
				$('#showTimekeeperModal').modal();
				emptyDivs();
				$("#messageTimekeeper").html("SCHEDULE");
				checkboxList = false;
				getAllEmployees("{{ csrf_token }}", "{% url 'getAllEmployees' %}");

			});

			$("#scheduleButton").click(function() {
				$('#showTimekeeperModal').modal();
				emptyDivs();
				$("#messageTimekeeper").html("SCHEDULE");
				checkboxList = false;
				getAllEmployees("{{ csrf_token }}", "{% url 'getAllEmployees' %}");

			});

			$("#timelogBack1").click(function() {
				emptyDivs();
				$('#showTimekeeperModal').modal();
				$("#messageTimekeeper").css("color", "#1F3801");	//green
				$("#messageTimekeeper").html("{% trans 'Select Employee(s)' %}:");
				emptyDivs();
				checkboxList = true;
				getAllEmployees("{{ csrf_token }}", "{% url 'getAllEmployees' %}");
				<!--$("#next").append("<input type='button' id='nextButton' value='NEXT' class='btnsTimekeeperShop' disabled/>");-->
			});

			$("#timelogBack2").click(function() {
				emptyDivs();
				$('#showTimekeeperModal').modal();
				$("#messageTimekeeper").css("color", "#1F3801");	//green
				$("#messageTimekeeper").html("Select an Employee:");
				checkboxList = false;
				getAllEmployees("{{ csrf_token }}", "{% url 'getAllEmployees' %}");
			});
			$("#btnSignature").click(function(){
				$("#messageTimekeeper").css("color", "#1F3801");	//green
				retrieveQuestions("{{ csrf_token }}", "{% url 'getChecklistAttendance' %}", document.getElementById("attendanceId").value);

			});

		});

		function tConvert (time) {
		  // Check correct time format and split into components
		  time = time.toString ().match (/^([01]\d|2[0-3])(:)([0-5]\d)(:[0-5]\d)?$/) || [time];

		  if (time.length > 1) { // If time format correct
			time = time.slice (1);  // Remove full string match value
			time[5] = +time[0] < 12 ? 'AM' : 'PM'; // Set AM/PM
			time[0] = +time[0] % 12 || 12; // Adjust hours
		  }
		  return time.join (''); // return adjusted time or original string
		}

		function checkPin(qr_code, userId){
			$("#messageTimekeeper").css("color", "#1F3801");	//green
			$("#messageTimekeeper").html("Enter 4-digit PIN:");

			document.getElementById("code").style.display = "block";
			$('#employee_pin').focus();
			checked_employees.push(qr_code);
			employees = qr_code;
			user_id = userId;
		}

		function inout(qr_code, clockedin){
			document.getElementById("code").style.display = "none";
			$("#messageTimekeeper").css("color", "#1F3801");	//green
			$("#messageTimekeeper").html("");

			emptyDivs();
			$("#timelogBack1").show();
			if(clockedin == 'out'){
				$("#clock-out").append('<input type="button"  value="{% trans 'CLOCK-OUT' %}" class="btnsTimekeeperShop"/>');
			}else if(clockedin == 'in') {
				$("#clock-in").append('<input type="button" value="{% trans 'CLOCK-IN' %}" class="btnsTimekeeperShop"/>');
			}else {
				if(employees.length > 1) {
							checkboxList = true;
							getSomeEmployees("{{ csrf_token }}", "{% url 'getAllEmployees' %}", employees);
						}else {
							timelogId(user_id);
						}
			}

		}

		function clockInOut(qr_code, userId) {
			checked_employees = [];
			checkPin(qr_code, userId);

		}

		function openAdd() {
			$('#qrCodeModal').modal();
		}

function addRemove() {


		var images = {
    		del: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA9tJREFUeNq0Vk1IVFEUPjNvNGcqUunHbhC1KRUM6RZM6VCG4hhGRRRREK2GIGjRpk1Ll21aRe2KiDYRrYpAsCCHGXxqalg2SQnqjMPM2KT21Jl5nXPfva/nm6Q2Xfh83nvP+b5z7znvvPGYpgn/c/ieeDzgwX+8FsL46EE8KFmAogs0NBekbwQs3Ea/V+Rryj01wrjYc/7WLV76bfyvI0I+Z27eJF8KMKw2tHP4B08QRrWei0g+OzsLwXCYjb57x8CKQjdlNOoyvWsRwfXI6Rs3eDabhaZQiH2MxxtwawqR0M5ajk8vI/nk5CQUCgXI5XLQcvIkG+nvLxOBP5B3X7vG5+bmhO/i4iI0HjnCPg8NNeDeA+2MdBzGiENdXWxmZgZWV1chnU5DK87HYrE1IuAi77x6lSsfQiAQgNePHumUR/JRJ9ApKe+jURbq7GTT09PCOJVKQbC9nY0PDtoi4CA/fuECV7YEv98Pb589E+QeCyAEaJSkyGg8zoJtbSyZTIoj09EPtrayxNgYk6acyI+eOiXyRTaEqqoqiL18aZN7rdz+FjClCJXi+PAwO4j3mMlkoFQqASWvkXP2dWKCoR0/3NEh7pz2CEQ+1NdHV2iTKwHPQ0nuqndxBW3d3SJKNaqrqwVhPp+31yorK2EkGtWJWLNgvx9lJzBdJ/mCEe9rbGSGYQgbei4vL9vkmqbBcCxWFrnzBL713hxyIpG+3t7I4WCQf5+fh6WlJTuhdJL5bNaOfN1W0S+VKh2okMpKvcLrhQxWlBoeeQUFOf8p/19FrDhAt6Edcji4+ot4/Vuam/lUIlG2T9ji97OsYTBnFZb1rXUEBHmovp6nsc7V+kascxNL0mm7FUVSDpG/CqjIT+zdyxewTNVVbfD5IJpK6UnDmN2DpD7HNTKcT6GI6RIpE1DkXbt28ZUfP2yCCmzpvZmMLlu4/g3J9rlESPSzS2SNgCI/t307N7EUnc4vcjlB7rWqRadkTiDZAZfIfpyPOUScAoL8Sm0t9xaLa8gfO8g1GVVRiowi2SGXSBPOB2VOKBit2VK7f72mhjsNCfeQ3JTk9D6/RnxAbKaEozOVpo5kLS4REo3iOgWm7bCMp3Ch4RhuqGTfkeRJxBucxxF5iXHEjBQJ4JPI/uB7G4NKiHPUIdrxq3YJYGCipsakJ84jdf/wrZS+EZdvuM7x/a5YANg0CfAdjzc3Yhi7pwGe92GXwPVaeSN+qlT5ktOTAq9GbEObneibwklxwDC2fAK4i92hf0F+BVSF+qSj6hQeKzWinAsSRbmmfixojq6iflyUZMdYlt2i8EuAAQCebgnbDx2SvgAAAABJRU5ErkJggg==',
		};

		var options =
			'<div>' +
				'<img class="del" src="' + images.del + '"/>' +
			'</div>';

		var stick = false;
		var locked = false;

		function removeOptions(force) {
			if (!stick || force) {
				var target = $('li.current');
				$('div', target).remove();
				 $(target).remove('div');
				 $(target).animate({
					paddingLeft: 20
				}, 200);
				 $(target).removeClass('current');
			}
		}

		function appendOptions(target) {
			$(target).append(options);
		}

		function showOptions(e) {
			var target = e.target;
			if (!$(target).hasClass('current')) {
				removeOptions(true);
				 $(target).addClass('current');
				 $(target).animate({
					paddingLeft: 10
				}, 200);
				appendOptions(target);
			}
		}

		var primaryAction = {
			run: function(li) {
				<!--alert('Primary Action');-->
			}
		};

		var deleteAction = {
			run: function(li) {
				$(li).fadeOut(500, function() {
					var index = id_scanned.indexOf($(this)[0].id);
					if (index > -1) {
						id_scanned.splice(index, 1);
					}

					$(this).remove();
					if($("ul").has("li").length == 0) {
						  $("ul").html("Please Add Employees");
					}
					locked = false;
					stick = false;

				});
			}
		}

		$('li').hover(function(e) {
			if (!locked && e.target.tagName === 'LI') {
				stick = false;
				showOptions(e);
			}
		}, function(e) {
			removeOptions();
		});

		$('ul').click(function(e) {
		   var target = e.target;
			stick = true;
			switch (target.tagName) {
				case 'LI':
				case 'SPAN':
					if (!locked) {
						editAction.reset();
						if (target.tagName === 'SPAN') {
							target = $(target).parent();
						}
						if ($(target).hasClass('current')) {
							primaryAction.run(target);
						}
						else {
							showOptions(e);
						}
					}
				break;
				case 'IMG':
					var li = $(target).parent().parent();
					stick = true;
					locked = true;

					 if ($(target).hasClass('del')) {
						 deleteAction.run(li);
					 }

				break;
			}
		});
}


		function getEmployeeShifts(token, url) {
			$.ajax({
				method : "POST",
				url : url,
				data : {"csrfmiddlewaretoken" : token},
				datatype : "json",
				beforeSend: function() {
					var target = document.getElementById('messageTimekeeper');

					spinner = new Spinner(opts).spin(target);
				},
				complete: function() {
					spinner.stop();
				},
				success : function(data, status, xhr) {
					if (data.success) {
						if (data.hour_started != 'None') {
							shiftStarted = 1;
						}
						for(var i = 0; i < data.breaks.length; i++) {
							if (data.breaks[i][1] == "None") {
								if (data.breaks[i][2] == 1) {
									lunchStarted = 1;
								} else {
									breakStarted = 1
								}
							}
						}
						if (data.hour_ended != "None") {
							shiftStarted = 0;
						}
					} else if (data.code == 1) {
						$('#showTimekeeperModal').modal();
						$("#messageTimekeeper").css("color", "#BB330C");	//red
						$("#messageTimekeeper").html("{% trans 'There are no shift records for this employee' %}.");
						//hideModal();
					} else if (data.code == 2) {
						$('#showTimekeeperModal').modal();
						$("#messageTimekeeper").css("color", "#BB330C");	//red
						$("#messageTimekeeper").html("{% trans 'Error. Contact Support' %}.");
						//hideModal();
					} else if (data.code == 3) {
						$('#showTimekeeperModal').modal();
						$("#messageTimekeeper").css("color", "#BB330C");	//red
						$("#messageTimekeeper").html("{% trans 'Error. Contact Support' %}.");
						//hideModal();
					}
				}
			});
		}


		function startShiftGroup(token, url, employees) {
			$.ajax({
				method : "POST",
				url : url,
				data : {"csrfmiddlewaretoken" : token, "qr_list": employees},
				datatype : "json",
				beforeSend: function() {
					var target = document.getElementById('messageTimekeeper');

					spinner = new Spinner(opts).spin(target);
				},
				complete: function() {
					spinner.stop();
				},
				success : function(data, status, xhr) {

					arrayErrors = [];
					arrayErrors[1] = '{% trans 'You need to finish the current shift before create a new one' %}.';
					arrayErrors[2] = '{% trans 'There is no users associated with this id' %}.';
					arrayErrors[5] = '{% trans 'Error. Contact Suport' %}.';
					arrayErrors[6] = '{% trans 'Error. Contact Suport' %}.';
					printResult(data);
					if (data.success) {
						$("#messageTimekeeper").css("color", "#1F3801");	//green
						$("#messageTimekeeper").html("{% trans 'Clock-in' %}:");
					} else {
					}
					checked_employees = [];
				},
				error: function(XMLHttpRequest, textStatus, errorThrown) {
					checked_employees = [];
                }
			});
		}

		function timelogId(idShow) {
			emptyDivs();
			$("#timelogBack2").show();
			$("#messageTimekeeper").css("color", "#1F3801");	//green
			$("#messageTimekeeper").html("SCHEDULE");
			var today = new Date();
			var dd = today.getDate();
			var mm = today.getMonth()+1; //January is 0!
			var yyyy = today.getFullYear();

			if(dd<10) {
				dd='0'+dd
			}

			if(mm<10) {
				mm='0'+mm
			}

			today = mm+'/'+dd+'/'+yyyy;
			$("#messageTimekeeper").append("<p align='center' style='margin-left:40px;'>"+today+"</p>");

			idTimelog = idShow;
			timelog("{{ csrf_token }}", "{% url 'timeLogById' %}");
			callChecklist("{{ csrf_token }}", "{% url 'retrieveAttendanceChecklist' %}", idTimelog);

		}

		function retrieveQuestions(token, url, id){
			$.ajax({
					method: "POST",
					url: url,
					async: false,
					data: {"csrfmiddlewaretoken": token,
						   "category": 1
					},
					datatype: "json",
					success: function(data, status, xhr){
						if(data.success){
							var attendanceId = id;
							questions = data.questions;
							emptyDivs();
							$("#btnSignature").append("<input type='hidden' id='attendanceId' value='" + attendanceId + "'>");
							$("#messageTimekeeper").css("margin-left", "7.5%");
							$("#messageTimekeeper").html("{% trans 'Please Fill in' %}:");
							$("#attendanceCheckList").css("display", "block");
							$("#attendanceCheckList").css("text-align", "center");
							$("#attendanceCheckList").css("font-size", "28px");
							$("#attendanceCheckList").append("<div class='form-group'>");
							$("#attendanceCheckList").append("<form role='form'>");
							$("#attendanceCheckList").append("<table id='taskTable' style='margin: auto;'>"+
							"<thead><tr>"+
							"<td>Job Code</td>"+
							"<td>Location</td>"+
							"<td>Hours</td>"+
							"</tr></thead>"+
							"<tbody><tr>"+

							"<td><select id='job1' name='inputAnswer' class='job tasks select-beast'>"+

							"<option value='599'>599</option>"+
							"<option value='600'>600</option>"+
							"</select></td>"+
							"<td ><select id='ranch1'  class='ranch  tasks' >"+
							"<option value='711674'>711674</option>"+
							"</select></td>"+
							"<td ><input pattern='[0-9]*' inputmode='numeric' id='hours1' type='number' class='taskHours  tasks' /></td>"+

							"</tr><tr>"+
							"<td><select id='job2' name='inputAnswer' class='job tasks select-beast'>"+

							"<option value='599'>599</option>"+
							"<option value='600'>600</option>"+
							"</select></td>"+
							"<td ><select id='ranch2'  class='ranch  tasks' >"+
							"<option value='711674'>711674</option>"+
							"</select></td>"+
							"<td><input pattern='[0-9]*' inputmode='numeric' id='hours2' type='number' class='taskHours tasks' /></td>"+

							"</tr><tr>"+
							"<td><select id='job3' name='inputAnswer' class='job tasks select-beast'>"+

							"<option value='599'>599</option>"+
							"<option value='600'>600</option>"+
							"</select></td>"+
							"<td ><select id='ranch3'  class='ranch  tasks' >"+
							"<option value='711674'>711674</option>"+
							"</select></td>"+
							"<td><input inputmode='numeric' id='hours3' type='number' class='taskHours tasks' /></td>"+

							"</tr></tbody>");


							$("#attendanceCheckList").append("</table></br>");
							$("#attendanceCheckList").append("</form>");
	    					$("#attendanceCheckList").append("</div>");
	    					$("#divSignNow").css("margin", "auto");
	    					$("#divSignNow").append("<input type='button' id='btnSignNow' onClick='callBtnSign()' style='box-shadow: 1px 1px 3px gray; border-radius: .25em;' value='{% trans 'SIGN NOW' %}'/>");
	    				}
					}
			});
		}

		function previousQuestion(){
			if (indexQuestions > 0) {
				indexQuestions -= 1;
				$("#attendanceCheckList").fadeOut(0);
				$("#indexQuestions").html("Question (" + (indexQuestions+1) + "/" + questions.length + ")");
				$("#answer").val(answer[indexQuestions]);
				showQuestion(questions[indexQuestions]);
				$("#attendanceCheckList").fadeIn(500);
			}

		}

		function saveQuestion(){
				$("#attendanceCheckList").fadeOut(0);
				answers[indexQuestions] = ($("input[name='inputAnswer']").val());
				saveAnswer("{{ csrf_token }}", "{% url 'saveAnswerChecklistAttendance' %}", questions[indexQuestions].id, answers[indexQuestions]);
				indexQuestions += 1;
				$("#indexQuestions").html("Question (" + (indexQuestions+1) + "/" + questions.length + ")");

			if (indexQuestions < questions.length){
				showQuestion(questions[indexQuestions]);
				$("input[name='inputAnswer']").val("");
				$("#attendanceCheckList").fadeIn(500);

			}else{
				indexQuestions = 0;
				$("#messageTimekeeper").css("margin", "auto");
				$("#messageTimekeeper").html("{% trans 'Checklist completed' %}!");
				$("#divSignNow").append("<input type='button' id='btnRetake' value='{% trans 'RETAKE IT' %}'/>");
				$("#btnRetake").css("margin-left", "5px");
			}

		}

		function showQuestion(question){
			$("#question").html(question.description);
		}


		function saveAnswer(token, url, questionId, answer){
			$.ajax({
				method : "POST",
				url : url,
				async: true,
				data : {"csrfmiddlewaretoken" : token,
						"question" : questionId,
						"answer" : answer,
						"id":idTimelog,
				},
				datatype : "json",
				success : function(data, status, xhr) {
					console.log(data.success);
				}
			});

		}

		function getAllEmployees(token, url) {
			$.ajax({
				method: "POST",
				url: url,
				data: {"csrfmiddlewaretoken": token },
				datatype: "json",
				beforeSend: function() {
					var target = document.getElementById('messageTimekeeper');
					spinner = new Spinner(opts).spin(target);
				},
				complete: function() {
					spinner.stop();
				},
				success: function(data, status, xhr){
					if(checkboxList == true) {
						for(var i = 0; i < data.employees.length; i++){
							if(data.employees[i].shift_status == "0"){
							$("#messageTimekeeper").append('<label  id="teamName'+i+'" style="font-size: 28px;text-align: left;box-shadow: 1px 1px 3px gray;margin-bottom: 20px;height: 65px;background:#DDD; width:100%;border-radius: .25em;"><input class="teamName" style="opacity:0" type="checkbox" onclick="clockInOut('+data.employees[i].qr_code+','+data.employees[i].user_id+')" name="teamRadio" value="' + data.employees[i].qr_code + '" id="team' + i +'"/> ' + data.employees[i].first_name + ' '+ data.employees[i].last_name +'</label>');
							} else if(data.employees[i].shift_status == "1"){
								$("#messageTimekeeper").append('<label  id="teamName'+i+'" style="font-size: 28px;text-align: left;box-shadow: 1px 1px 3px gray;margin-bottom: 20px;height: 65px;background:#DDD; width:100%;border-radius: .25em;"><input class="teamName" style="opacity:0" type="checkbox" onclick="clockInOut('+data.employees[i].qr_code+','+ data.employees[i].user_id+')" name="teamRadio" value="' + data.employees[i].qr_code + '" id="team' + i +'"/> ' + data.employees[i].first_name + ' '+ data.employees[i].last_name +'<span style="float: right;background: #FFFFFF;border-radius: .5em;padding: 5px;font-size: 24px;">IN</span></label>');

							}else if(data.employees[i].shift_status == "2"){
								$("#messageTimekeeper").append('<label  id="teamName'+i+'" style="font-size: 28px;text-align: left;box-shadow: 1px 1px 3px gray;margin-bottom: 20px;height: 65px;background:#DDD; width:100%;border-radius: .25em;"><input class="teamName" style="opacity:0" type="checkbox" onclick="clockInOut('+data.employees[i].qr_code+','+ data.employees[i].user_id+')" name="teamRadio" value="' + data.employees[i].qr_code + '" id="team' + i +'"/> ' + data.employees[i].first_name + ' '+ data.employees[i].last_name +' <span style="float: right;background: #003DFF;border-radius: .5em;padding: 5px;font-size: 24px;">OUT</span></label>');

							}else if(data.employees[i].shift_status == "3"){
								$("#messageTimekeeper").append('<label  id="teamName'+i+'" style="font-size: 28px;text-align: left;box-shadow: 1px 1px 3px gray;margin-bottom: 20px;height: 65px;background:#DDD; width:100%;border-radius: .25em;"><input class="teamName" style="opacity:0" type="checkbox" onclick="clockInOut('+data.employees[i].qr_code+','+ data.employees[i].user_id+')" name="teamRadio" value="' + data.employees[i].qr_code + '" id="team' + i +'"/> ' + data.employees[i].first_name + ' '+ data.employees[i].last_name +' <span style="float: right;background: #4AEF0D;border-radius: .5em;padding: 5px;font-size: 24px;">DONE</span></label>');

							}

						}
					}else{
						for(var i = 0; i < data.employees.length; i++){
							if(data.employees[i].shift_status == "0"){
								$("#messageTimekeeper").append('<label  id="teamName'+i+'" style="font-size: 28px;text-align: left;box-shadow: 1px 1px 3px gray;margin-bottom: 20px;height: 65px;background:#DDD; width:100%;border-radius: .25em;"><input id='+data.employees[i].user_id+' class="teamName" style="opacity:0" type="checkbox" onclick="timelogId(this.id)" name="teamRadio" value="' + data.employees[i].qr_code + '" id="team' + i +'"/> ' + data.employees[i].first_name + ' '+ data.employees[i].last_name +' </label>');
							} else if(data.employees[i].shift_status == "3") {
								$("#messageTimekeeper").append('<label  id="teamName'+i+'" style="font-size: 28px;text-align: left;box-shadow: 1px 1px 3px gray;margin-bottom: 20px;height: 65px;background:#DDD; width:100%;border-radius: .25em;"><input id='+data.employees[i].user_id+' class="teamName" style="opacity:0" type="checkbox" onclick="timelogId(this.id)" name="teamRadio" value="' + data.employees[i].qr_code + '" id="team' + i +'"/> ' + data.employees[i].first_name + ' '+ data.employees[i].last_name +' <span style="float: right;background: #4AEF0D;border-radius: .5em;padding: 5px;font-size: 24px;">DONE</span></label>');
							}else if(data.employees[i].shift_status == "2") {
								$("#messageTimekeeper").append('<label  id="teamName'+i+'" style="font-size: 28px;text-align: left;box-shadow: 1px 1px 3px gray;margin-bottom: 20px;height: 65px;background:#DDD; width:100%;border-radius: .25em;"><input id='+data.employees[i].user_id+' class="teamName" style="opacity:0" type="checkbox" onclick="timelogId(this.id)" name="teamRadio" value="' + data.employees[i].qr_code + '" id="team' + i +'"/> ' + data.employees[i].first_name + ' '+ data.employees[i].last_name +' <span style="float: right;background: #003DFF;border-radius: .5em;padding: 5px;font-size: 24px;">OUT</span></label>');
							}else if(data.employees[i].shift_status == "1") {
								$("#messageTimekeeper").append('<label  id="teamName'+i+'" style="font-size: 28px;text-align: left;box-shadow: 1px 1px 3px gray;margin-bottom: 20px;height: 65px;background:#DDD; width:100%;border-radius: .25em;"><input id='+data.employees[i].user_id+' class="teamName" style="opacity:0" type="checkbox" onclick="timelogId(this.id)" name="teamRadio" value="' + data.employees[i].qr_code + '" id="team' + i +'"/> ' + data.employees[i].first_name + ' '+ data.employees[i].last_name +' <span style="float: right;background: #FFFFFF;border-radius: .5em;padding: 5px;font-size: 24px;">IN</span></label>');
							}

						}
					}


				}
			});
		}

		function getSomeEmployees(token, url, qr_list) {
			$.ajax({
				method: "POST",
				url: url,
				data: {"csrfmiddlewaretoken": token },
				datatype: "json",
				success: function(data, status, xhr){
						for(var i = 0; i < qr_list.length; i++){
							if(qr_list.indexOf(data.employees[i].qr_code) > -1 ){
								$("#messageTimekeeper").html("Summary");
								$("#messageTimekeeper").append('<label  id="teamName'+i+'" style="box-shadow: 1px 1px 3px gray;margin-bottom: 20px;height: 65px;background:#DDD; width:100%;border-radius: .25em;"><input class="teamName" style="opacity:0" type="checkbox" onChange="checkState()" name="teamRadio" value="' + data.employees[i].qr_code + '" id="team' + i +'"/> ' + data.employees[i].first_name + ' '+ data.employees[i].last_name +' </label>');

							}

						}
				}
			});
		}

		function startBreakGroup(token, url) {
			$.ajax({
				method : "POST",
				url : url,
				acync: false,
				data : {"csrfmiddlewaretoken" : token, "qr_list": id_pushed, "lunch": lunch},
				datatype : "json",
				beforeSend: function() {
					var target = document.getElementById('messageTimekeeper');
					spinner = new Spinner(opts).spin(target);

				},
				complete: function() {
					spinner.stop();
				},
				success : function(data, status, xhr) {
					arrayErrors = [];
					arrayErrors[1] = '{% trans 'You cannot start two breaks at the same time' %}.';
					arrayErrors[2] = '{% trans 'The shift for today was already finished' %}.';
					arrayErrors[3] = '{% trans 'You need to start a shift first' %}.';
					arrayErrors[5] = '{% trans 'Error. Contact Suport' %}.';
					arrayErrors[6] = '{% trans 'Error. Contact Suport' %}.';
					printResult(data);
					if (data.success) {
						$("#messageTimekeeper").css("color", "#1F3801");	//green
						if (lunch == 0) {
							$("#messageTimekeeper").html("{% trans 'Break Started' %}:");
						}
						if (lunch == 1) {
							$("#messageTimekeeper").html("{% trans 'Lunch Started' %}:");
						}
					}
				}
			});
		}

		function stopShiftGroup(token, url, employees) {
			$.ajax({
				method: "POST",
				url: url,
				data: {"csrfmiddlewaretoken": token, "qr_list": employees},
				datatype: "json",
				beforeSend: function() {
					var target = document.getElementById('messageTimekeeper');

					spinner = new Spinner(opts).spin(target);
				},
				complete: function() {
					spinner.stop();
				},
				success: function(data, status, xhr){
					arrayErrors = [];
					arrayErrors[2] = '{% trans 'The shift for today was already finished' %}.';
					arrayErrors[3] = '{% trans 'You have not started a shift yet' %}.';
					arrayErrors[4] = '{% trans 'This user is not authorized to use the system' %}.';
					arrayErrors[5] = '{% trans 'Error. Contact Suport' %}.';
					arrayErrors[6] = '{% trans 'Error. Contact Suport' %}.';
					<!--printResult(data);-->
					if (data.success) {

						$("#messageTimekeeper").css("color", "#1F3801");	//green
						<!--$("#messageTimekeeper").html("Clock-out:");-->
						$("#messageTimekeeper").html("Summary");
						checkboxList = false;
						if(employees.length > 1) {
							checkboxList = true;
							getSomeEmployees("{{ csrf_token }}", "{% url 'getAllEmployees' %}", employees);
						}else {
							timelogId(data.success[0].id);
							<!--timelog("{{ csrf_token }}", "{% url 'timeLogById' %}");-->
						}

					}
					checked_employees = [];
				},
				error: function(XMLHttpRequest, textStatus, errorThrown) {
					checked_employees = [];
                }
			});
		}
		function callChecklist(token, url, user_id) {
			$.ajax({
				method: "POST",
				url: url,
				data: {"csrfmiddlewaretoken": token, "id": user_id},
				datatype: "json",
				beforeSend: function() {
					var target = document.getElementById('messageTimekeeper');

					spinner = new Spinner(opts).spin(target);
				},
				complete: function() {
					spinner.stop();
				},
				success: function(data, status, xhr){
					if (data.success) {
						var attendanceId = $("#attendanceId").val();
						emptyDivs();
						$("#btnSignature").append("<input type='hidden' id='attendanceId' value='" + attendanceId + "'>");
    					$("#messageTimekeeper").css("color", "#1F3801");	//green
    					<!--if(data.checklist.length == 0 ){-->
    						<!--$("#messageTimekeeper").html("{% trans 'Click to Sign' %}:");-->
    						<!--$("#divSignNow").append("<input type='button' style='box-shadow: 1px 1px 3px gray; border-radius: .25em;' id='btnSignNow' value='{% trans 'SIGN NOW' %}'/>");-->
    						<!--$("#btnSignNow").attr("disabled", false);-->
    					<!--}else {-->
    					<!--$("#messageTimekeeper").html("{% trans 'Check Before Signing' %}:");-->
    					$("#questions").css("text-align", "left");
    					$("#questions").css("font-size", "20px");
    					$("#questions").append("<table>");


    					for (i = 0; i < data.checklist.length; i++) {
    						$("#questions").append("<tr><td><label style='font-weight: 500;'><input type='checkbox' onClick='allChecked(" + data.checklist.length + ")' class='checkQuestions'/>&nbsp;&nbsp;" + data.checklist[i].description + "</label></td></td>");
    					}
    					$("#questions").append("</table>");
    					<!--$("#divSignNow").append("<input type='button' style='box-shadow: 1px 1px 3px gray; border-radius: .25em; margin-right: 50px;' id='btnSignNow' value='{% trans 'SIGN NOW' %}'/>");-->

    					<!--$("#btnSignNow").attr("disabled", true);-->
    					<!--}-->
					}
				}
			});
		}

		function declineShift(token, url, attendanceid) {
			$.ajax({
				method: "POST",
				url: url,
				data: {"csrfmiddlewaretoken": token, "attendance_id":attendanceid},
				datatype: "json",
				beforeSend: function() {
					var target = document.getElementById('messageTimekeeper');

					spinner = new Spinner(opts).spin(target);
				},
				complete: function() {
					spinner.stop();
				},
				success: function(data, status, xhr){
					if (data.success) {
						emptyDivs();
						$("#messageTimekeeper").html("{% trans 'Shift Declined' %}");
					}
				}
			});
		}

		function allChecked(questionsN) {
			var countQuestions = $('input:checkbox[class=checkQuestions]:checked');
			if (questionsN == countQuestions.length) {
				 $("#btnSignNow").css("background", "#2fce4a");
				 $("#btnSignNow").attr("disabled", false);
			} else {
				$("#btnSignNow").css("background", "#E5E5E5");
				$("#btnSignNow").attr("disabled", true);
			}
		}


		function callBtnSign() {
			<!--saveQuestion();-->
			var taskData = [];
			job1 = document.getElementById('job1').value;
			job2 = document.getElementById('job2').value;
			job3 = document.getElementById('job3').value;
			ranch1 = document.getElementById('ranch1').value;
			ranch2 = document.getElementById('ranch2').value;
			ranch3 = document.getElementById('ranch3').value;
			hours1 = document.getElementById('hours1').value;
			hours2 = document.getElementById('hours2').value;
			hours3 = document.getElementById('hours3').value;
			if(job1 != '' && ranch1 != '' && hours1 != ''){
				taskData.push(job1);
				taskData.push(ranch1);
				taskData.push(hours1);
			}
			if(job2 != '' && ranch2 != '' && hours2 != ''){
				taskData.push(job2);
				taskData.push(ranch2);
				taskData.push(hours2);
			}
			if(job3 != '' && ranch3 != '' && hours3 != ''){
				taskData.push(job3);
				taskData.push(ranch3);
				taskData.push(hours3);
			}


			updateTaskFlow("{{ csrf_token }}", "{% url 'updateLightTaskFlow' %}", JSON.stringify(taskData));
			$('#showTimekeeperModal').modal('hide');
			$('#signModal').modal();


		}

		function updateTaskFlow(token, url, taskData) {
            $.ajax({
					method : "POST",
					url : url,
					data : {
						"csrfmiddlewaretoken" : token,
						"task_data" : taskData,
						"id": idTimelog,
					},
					datatype : "json",
					beforeSend: function() {
					var target = document.getElementById('messageTimekeeper');

					spinner = new Spinner(opts).spin(target);
					},
					complete: function() {
						spinner.stop();
					},
					success : function(data, status, xhr) {
					    if(data.success){
                            $("#showTimeKeeperModal").modal();
                            $("#messageTimekeeper").html("Submitted Successfully");

					    } else {
						    $('#showTimekeeperModal').modal();
						    $("#messageTimekeeper").html("There was an error. Not Submitted.");
					    }
					}

			});
        }

		function saveSignature(token, url, attendanceId){
			$.ajax({
				method : "POST",
				url : url,
				async: false,
				data : {"csrfmiddlewaretoken" : token, "id": idTimelog, "signature": document.getElementById("code2").value},
				datatype : "json",
				beforeSend: function() {
					var target = document.getElementById('messageTimekeeper');

					spinner = new Spinner(opts).spin(target);
				},
				complete: function() {
					spinner.stop();
				},
				success : function(data, status, xhr) {
						$('#signModal').modal('hide');
				}
			});
		}


		function timelog(token, url) {
			$.ajax({
				method : "POST",
				url : url,
				data : {"csrfmiddlewaretoken" : token, "qr_code": idTimelog, "id":idTimelog},
				datatype : "json",
				beforeSend: function() {
					var target = document.getElementById('divTimelog');

					spinner = new Spinner(opts).spin(target);
				},
				complete: function() {
					spinner.stop();
				},
				success : function(data, status, xhr) {
					var i = 0;
					var breaks = 1;
					var lunchs = 1;
					workBreak = [];
					breakN = [];
					breakBeg = [];
					breakEnd = [];
					lun = [];
					currentStart = data.Attendance_start;
					currentEnd = data.Attendance_end;
					if(data.no_attendance == 'false'){
					if (data.Attendance_end == 'In Progress') {
						$("#divTimelog").append("<table id='tableTimelog' ><tr><td colspan='2'>Start Shift: " + tConvert(data.Attendance_start) + "</td></tr>");
						var n=1;
						breakDuration = "";

						for (i = 0; i < data.breaks.length; i++) {
							n=n+1;
							if (data.breaks[i].lunch == 0){
								$("#tableTimelog").append("<tr><td id='colBorderTimelog'>" + data.breaks[i].breakDuration + "</td><td>#" + breaks + " Break " + tConvert(data.breaks[i].breakStart) + " - " + tConvert(data.breaks[i].breakStop) + "</td></tr>");
								breaks++;
							} else {
								$("#tableTimelog").append("<tr><td id='colBorderTimelog'>" + data.breaks[i].breakDuration + "</td><td>#" + lunchs + " Lunch " + tConvert(data.breaks[i].breakStart) + " - " + tConvert(data.breaks[i].breakStop) + "</td></tr>");
								lunchs++;
							}
							breakDuration = "";

						}
						$("#tableTimelog").append("<tr id='trStopShift'><td colspan='2'>End Shift: " + tConvert(data.Attendance_end) + "</td></tr>");
					} else {
						$("#divTimelog").append("<table id='tableTimelog' ><tr id='trStartShift'><td colspan='2'>Start Shift: " + tConvert(data.Attendance_start) + "</td></tr>");
							var n=1;
							breakDuration = "";

							for (i = 0; i < data.breaks.length; i++) {
								workBreak[data.breaks[i].breakId] = data.breaks[i].breakDuration;
								breakN[data.breaks[i].breakId] = breaks;
								breakBeg[data.breaks[i].breakId] = data.breaks[i].breakStart;
								breakEnd[data.breaks[i].breakId] = data.breaks[i].breakStop;
								n = n+1;
								breakDuration = "";
								if (data.breaks[i].lunch == 0){
									lun[data.breaks[i].breakId] = 0
									$("#tableTimelog").append("<tr id='" + data.breaks[i].breakId + "'><td class='colBorderTimelog'>" + data.breaks[i].breakDuration + "</td><td>#" + breaks + " Break " + tConvert(data.breaks[i].breakStart) + " - " + tConvert(data.breaks[i].breakStop) + "</td></tr>");
									breaks++;
								} else {
									lun[data.breaks[i].breakId] = 1;
									$("#tableTimelog").append("<tr id='" + data.breaks[i].breakId + "'><td class='colBorderTimelog'>" + data.breaks[i].breakDuration + "</td><td>#" + lunchs + " Lunch " + tConvert(data.breaks[i].breakStart) + " - " + tConvert(data.breaks[i].breakStop) + "</td></tr>");
									lunchs++;
								}
							}
							$("#tableTimelog").append("<tr id='trStopShift'><td colspan='2'>End Shift: " + tConvert(data.Attendance_end) + "</td></tr>");
							$("#btnSignature").append("<button type='button' id='attendanceId'  style='background:green;' value='"+data.attendanceId+"' class='btnsTimekeeperShop'>ACCEPT</button>");
							<!--alert(data.attendanceId);-->
							$("#btnSignature").append("<input type='button' id='btnDeclineCheckList' style='background:#BB1818;margin-left 35px;' value='DECLINE' class='btnsTimekeeperShop'/>");
							$("#btnDeclineCheckList").css("background-color", "#B83419");
							$("#btnDeclineCheckList").css("margin-left", "35px");
							$("#btnDeclineCheckList").click(function(){
								declineShift("{{ csrf_token }}", "{% url 'declineShift' %}", data.attendanceId);
							});
						}
					} else {
						$("#divTimelog").append("No Attendances Today <p>Please start a shift to see your schedule.</p>");
					}
					$("#tableTimelog").append("<tr><td colspan='3'>Total: " + data.Total + " hours</td></tr>");
				}
			});
		}

		function printResult(data) {

			if (data.success && data.success.length > 0) {
				$("#success").css("color", "#1F3801");	//green
				$("#success").append("{% trans 'SUCCESS' %}");
			}
			if (data.error && data.error.length > 0) {
				$("#error").css("color", "#BB330C");	//red
				$("#error").append("{% trans 'ERROR' %}");
			}

		}
		function popoverError(popId) {
			$('#' + popId).popover();
		}

		function hideModal() {
			setTimeout(function(){
    			$('#showTimekeeperModal').modal('hide')
			}, 3000);
		}
		function emptyDivs() {
			$("#success").empty();
			$("#error").empty();
			$("#scheduleButton").empty();
			$("#team").empty();
			$("#clock-in").empty();
			$("#clock-out").empty();
			$("#divTimelog").empty();
			$("#timelogBack1").hide();
			$("#timelogBack2").hide();
			$("#next").empty();
			$("#questions").empty();
			$("#btnSignature").empty();
			$("#divSignNow").empty();
			$("#btnSignNow").empty();
			$("#btnDeclineCheckList").empty();
			$("#declineButton").empty();
			$("#acceptButton").empty();
			$("#attendanceCheckList").empty();
			document.getElementById("code").style.display = "none";
		}

		function updateStartShift(token, url, shift_id, new_time) {
			$.ajax({
				method : "POST",
				url : url,
				data : {"csrfmiddlewaretoken" : token, "shift_id": shift_id, "new_time": new_time},
				datatype : "json",
				beforeSend: function() {
					var target = document.getElementById('messageTimekeeper');

					spinner = new Spinner(opts).spin(target);
				},
				complete: function() {
					spinner.stop();
				},
				success : function(data, status, xhr) {
					if (data.success) {
						emptyDivs();
						$("#timelogBack2").show();
						$("#messageTimekeeper").css("color", "#1F3801");	//green
						$("#messageTimekeeper").html("SCHEDULE");
						timelog("{{ csrf_token }}", "{% url 'timeLogById' %}");
					}
				}
			});
		}

		function addEmployeeGroup(keeppingAdd) {
			if (keeppingAdd == false) {
				$("#addEmployee").modal("hide");
				$("#qrCodeModal").modal("hide");
			} else {
				$("#qrCodeModal").modal();
				$("#addEmployee").modal("hide");
			}
		}
		function checkEmployeeScanned(token, url, id) {
				$.ajax({
					method : "GET",
					url : url,
					//async: false,
					data : {
						"csrfmiddlewaretoken" : token,
						"qr_code" : id
					}, // id could be qrCode or employeeId
					datatype : "json",
					success : function(data, status, xhr) {
						$("#errorQrCode").html("")

						if (data.success) {
							if(id_scanned.indexOf(data_scanned.qr_code)==-1){
								$("#qrCodeModal").modal("hide");
								feedBackQrCode("show", "green", "{% trans 'Enter your PIN:' %}");
								data_scanned.qr_code = id;
								data_scanned.employee = data.employee;
								data_scanned.validated = "false";
								$("#pin_input").show();
							  }
							else{
							  <!--alert("element found");-->
							  }


						} else {
							feedBackQrCode("show", "red", "{% trans 'This employee does not exist. Please enter another ID.' %}");
						}
					}
				});

		}

		function checkEmployeePassword(token, url, id, password) {
				$.ajax({
					method : "POST",
					url : url,
					//async: false,
					data : {
						"csrfmiddlewaretoken" : token,
						"qr_code" : id,
						"password" : password,
					},
					beforeSend: function() {
						var target = document.getElementById('messageTimekeeper');

						spinner = new Spinner(opts).spin(target);
					},
					complete: function() {
						spinner.stop();
					},
					success : function(data, status, xhr) {
						$("#errorQrCode").html("")
						if (data.success) {
							$("#qrCodeModal").modal("hide");
							<!--feedBackQrCode("show", "green", "{% trans 'Successfully Validated.' %}");-->
							var clockedin = data.clockedin;
							inout(id, clockedin);
						} else {
						    data_scanned = {};
						    $("#messageTimekeeper").html("Incorrect PIN. Please try again.");
						    document.getElementById("messageTimekeeper").style.color = "red";
							<!--feedBackQrCode("show", "red", "{% trans 'Incorrect PIN. Please try again.' %}");-->
						}
					}
				});

		}


		function feedBackQrCode(modal, color, message){
			$("#addEmployee").modal(modal);
			$("#errorQrCode").css("color", color)
			$("#errorQrCode").html(message)
			$("#qr_code").val(""); // Clean input text #qr_code
		}
		</script>
		<style>
            .errorIcon {
                background: url('../imgSmall/errorIcon.png') no-repeat top left !important;
                background-size: 100% 100% !important;
                width: 20px !important;
                height: 20px !important;
                border: none !important;
            }

			label {
				 padding: 10px;
				 margin: 0px;
				 display: block;
			}
			#tableMessage {
				margin: auto;
				width: 90%;
				padding: 10px;
				text-align: center;
			}
			#tableMessage tr, #tableMessage td {
				margin: auto;
				text-align: center;
			}
		</style>
	</head>
	<body>
		<header id="head"></header>
		<input type="hidden" value="1" id="url">
		<div id="wrapper">
			<div id="content">
				<div class="namePage">
					<img style="height:35px;" src="{% static 'imgSmall/iconTimekeeper.png' %}"/>
					{% trans 'HC TIMEKEEPER' %}
				</div>

				<div class="row">
				<div class="row" style="margin-top: 65px;">
					<div class="col-xs-12 col-md-12">
						<input type="button" id="shift" value="{% trans 'CLOCK IN/OUT' %}" class="btnsTimekeeperShop"/>
					</div>
				</div>

			</div>
		</div>
		<footer>
			&copy;2016 HeavyConnect, Inc.
		</footer>

		<div id="clearBoth"></div>
		<!-- MODAL SIGNATURE - TIMEKEEPER -->
		<div class="modal fade" id="signModal" role="dialog">
			<div>
				<!-- Modal content-->
				<div class="modal-content signModalDialog">
					<button type="button" class="closeSignature" data-dismiss="modal"></button>
					<div class="modal-title" id="titleSign">{% trans 'Enter 4-digit PIN:' %}</div>
					<div class="modal-body" id="signatureContent">
						<input pattern="[0-9]*" type="password" style="height:70px; width:200px; border-radius: .15em;font-size:24px;" id="code2" style="color:black;" placeholder="{% trans 'Type PIN' %}"/>
						<!--<button type="button" id="clearSignature" class="btn btn-default">{% trans 'Clear' %}</button>-->
						<!--<button type="button" class="btn btn-default" data-dismiss="modal">{% trans 'Cerrar' %}</button>-->

							<button style="height:60px; width:100px;box-shadow: -1px 1px 7px gray;" type="button" id="saveSignature" class="btn btn-success" >
								{% trans 'SIGN' %}
							</button>

				</div>
			</div>
		</div>
	  </div>

		<!-- MODAL OF ALERT - TIMEKEEPER -->
		<div class="modal fade" id="showTimekeeperModal" role="dialog">
			<div class="modal-dialog full-size" style="width:95%;">
				<!-- Modal content-->
				<div class="modal-content modalTimekeeper">
					<div class="modal-body">
						<button type="button" id="timelogBack1" style="background: url('/static/imgSmall/buttons/backPastTasks.png') no-repeat top left;
    background-size: 100% 100%;
    width: 40px;
    height: 40px;
    float: left;
    border: none;
    border-radius: 7px;
    box-shadow: -1px 1px 7px gray;
    margin: 0px;
    padding: 0px;"></button>
						<button type="button" id="timelogBack2" style="background: url('/static/imgSmall/buttons/backPastTasks.png') no-repeat top left;
    background-size: 100% 100%;
    width: 40px;
    height: 40px;
    float: left;
    border: none;
    border-radius: 7px;
    box-shadow: -1px 1px 7px gray;
    margin: 0px;
    padding: 0px;"></button>
						<button type="button" class="closeTimekeeper" data-dismiss="modal"></button>
						<span id="messageTimekeeper"></span>

						<table id="tableMessage">
							<tr>
								<td><div id="success"></div></td>
								<td><div id="error"></div></td>

							</tr>
							<tr>
								<td></td>
							</tr>
						</table>

						<div style="margin-top: 30px;" id="clock-in"></div>
						<div id="clock-out"></div>
						<div id="divTimelog"></div>
						<div id="scheduleButton"></div>


						<div id="questions"></div>
						<div id="attendanceCheckList"></div>
						<div id="btnSignature"></div>
						<div id="divSignNow"></div>
						<div id="next"></div>
						<div id="acceptButton"></div>
						<div id="declineButton"></div>
						<div id="code" style="display:none;">
							<input pattern="[0-9]*" type="password" id="employee_pin" style="color:black;border-radius:.15em;" placeholder="{% trans 'Type your PIN' %}"/>
							<button id="submit_pin" style="height:55px; width:60px;box-shadow: -1px 1px 7px gray;" title="Play" type="button" class="btn btn-success btn-xl" onclick="checkEmployeePassword('{{ csrf_token }}', '/home/checkEmployeePassword/', checked_employees[0], $('#employee_pin').val());"><span class="glyphicon glyphicon-play"></span></button>
						</div>
						<br>
						<div class="both"></div>
					</div>
				</div>
			</div>
		</div>

		<div class="modal fade" id="qrCodeModal" role="dialog">
				<!-- Modal content-->
            <div class="modal-dialog full-size" style="text-align: center;">
				<div class="modal-content qrCodeModalDialog">
					<div class="modal-body" id="QrCodeContent">
                        <span style="font-size:30px; font-weight:600;">Search Employee</span>
					<button type="button" class="closeEquip" data-dismiss="modal"></button>
					<div id="QR-Code" style="font-size: 25px;">
						<div class="panel panel-primary" style="border: none;">
							<div style="margin auto 40px; text-align: center; margin-top: 20px;">
								<input pattern="[0-9]*" type="password" id="qr_code" style="color:black;" placeholder="{% trans 'Type PIN' %}"/>

								<button id="submit" title="Play" type="button" class="btn btn-success btn-xl" onclick="checkEmployeeScanned('{{ csrf_token }}', '/home/checkEmployeeQrCode/', $('#qr_code').val());">
									<!--<span class="glyphicon glyphicon-play"></span>-->
								</button>
							</div>
						</div>
					</div>
				</div>
		</div>
            </div>
	  </div>

	  <!-- Modal Confirm to Add another employee -->
		<div class="modal fade" id="addEmployee" role="dialog">
			<div class="modal-dialog">
				<!-- Modal content-->
				<div class="modal-content modalTask" style="text-align: center;">
					<button type="button" style="background: url('/static/imgSmall/buttons/esc.png') no-repeat top left;
    background-size: 100% 100%;
    width: 50px;
    height: 50px;
    float: right;
    border: none;
    border-radius: 7px;
    box-shadow: -1px 1px 7px gray;
    margin: 0px;
    padding: 0px;" class="closeTask" data-dismiss="modal"></button>

					</br>
					<span id="errorQrCode" style="font-weight: 600; text-align: center;font-size:30px; "></span>
					<div class="modal-body equipmentAlertModalBody">
                        <div id="PIN" style="font-size: 25px;">
						<div class="panel panel-primary" style="border: none;">
							<div id="pin_input" style="margin auto 40px; text-align: center; margin-top: 20px;">
								<input pattern="[0-9]*" type="password" id="employee_pin2" style="color:black;" placeholder="{% trans 'Type your PIN' %}"/>

								<button id="submit_pin2" title="Play" type="button" class="btn btn-success btn-xl" onclick="checkEmployeePassword('{{ csrf_token }}', '/home/checkEmployeePassword/', `${data_scanned.qr_code}`, $('#employee_pin2').val());">
									<span class="glyphicon glyphicon-play"></span>
								</button>
							</div>
						</div>
					</div>
					</div>

					<div class="both"></div>
				</div>
			</div>
		</div>
	</body>
</html>