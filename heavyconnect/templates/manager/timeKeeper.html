<!DOCTYPE html>
<html lang="en">
	<head>
		{% load staticfiles %}
		{% load i18n %}
		<script src="{% static 'js/jquery-1.11.2.min.js' %}"></script>
		<script src="{% static 'js/bootstrap-datepicker.min.js' %}"></script>
		<script src="{% static 'css/bootstrap/js/tooltip.js' %}"></script>
		<script src="{% static 'js/script.js' %}"></script>
		<link rel="stylesheet" href="{% static 'css/bootstrap-datepicker.min.css' %}">
		<link rel="stylesheet" href="https://cdn.datatables.net/1.10.11/css/dataTables.bootstrap.min.css">
		<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
		<script src="https://cdn.datatables.net/1.10.11/js/jquery.dataTables.min.js"></script>
		<script src="https://cdn.datatables.net/1.10.11/js/dataTables.bootstrap.min.js"></script>
		<script src="{% static 'js/timeKeeper.js'%}"></script>
		<script type="text/javascript" src="//cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.8.1/bootstrap-table.min.js"></script>
		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.8.1/bootstrap-table.min.css">

		<style>
		.dropdown-check-list {
		  display: inline-block;
			position: relative;
		}
		.dropdown-check-list .anchor {
		  position: relative;
		  cursor: pointer;
		  display: inline-block;
		  padding: 5px 50px 5px 10px;
		  border: 1px solid #ccc;
		}
		.dropdown-check-list .anchor:after {
		  position: absolute;
		  content: "";
		  border-left: 2px solid black;
		  border-top: 2px solid black;
		  padding: 5px;
		  right: 10px;
		  top: 20%;
		  -moz-transform: rotate(-135deg);
		  -ms-transform: rotate(-135deg);
		  -o-transform: rotate(-135deg);
		  -webkit-transform: rotate(-135deg);
		  transform: rotate(-135deg);
		}
		.dropdown-check-list .anchor:active:after {
		  right: 8px;
		  top: 21%;
		}
		.dropdown-check-list ul.items {
		  padding: 2px;
		  display: none;
		  margin: 0;
		  border: 1px solid #ccc;
		  border-top: none;
		}
		.dropdown-check-list ul.items li {
		  list-style: none;
			position: relative;
		}
		.highlight{
			background-color:yellow;
		}
		</style>
		<script>
		var id_checked = [];
		var name_checked = [];
		var correct_index = 0;
			$(document).ready(function() {

				$("#foot").load("{% url 'footer' %}");
				$("#head").load("{% url 'headerManager' %}");
				var today = new Date();
				var dd = today.getDate();
				var mm = today.getMonth()+1;
				var yyyy = today.getFullYear();

				if(dd<10) {
					dd='0'+dd
				}

				if(mm<10) {
					mm='0'+mm
				}

				today = mm+'/'+dd+'/'+yyyy;

				$('#list1').click( function(event){
					event.stopPropagation();
					<!--$('#items').toggle();-->
				});

				$(document).click( function(){
					$('#items').hide();
				});

				$("#report_table #checkall").click(function () {
					if ($("#report_table #checkall").is(':checked')) {
						$("#report_table input[type=checkbox]").each(function () {
							$(this).prop("checked", true);
							user_id = this.id;
							if(user_id != "checkall"){
								id_checked.push(user_id);
							}
						});

					} else {
						$("#report_table input[type=checkbox]").each(function () {
							$(this).prop("checked", false);
							user_id = this.id;
							index = id_checked.indexOf(user_id);
							id_checked.splice(index, 1);
						});
					}

					if(id_checked.length == 0){
						document.getElementById("remove").disabled = true;
					} else {
						document.getElementById("remove").disabled = false;
					}
				});
				$(function(){
					$('a, button').click(function() {
						$(this).toggleClass('active');
					});
				});
				$("input[name='nameSelected']").change(function() {

								if ($("input[id='"+this.id+"']").is(":checked")) {
										user_id = this.id;
										name_checked.push(user_id);
									} else {
										user_id = this.id;
										index = name_checked.indexOf(user_id);
										name_checked.splice(index, 1);
									}
								});

				getAllEmployees("{{ csrf_token }}", "{% url 'getAllEmployees' %}");
				getReport("{{ csrf_token }}", "{% url 'timeKeeperDailyReport' %}", today, today, name_checked);
				$("#remove").click(function() {
					console.log('hi');
					ids = id_checked;
					total = ids.length;
					current_step = correct_index+1;
					string_step = "("+current_step+"/"+total+")";
					$('#step').html(string_step);
					getNextAttendanceInList(ids[0]);

				}
				);

				$('#status').tooltip();

				$("input[name='rowSelected']").change(function() {
				   if ($("input[id='"+this.id+"']").is(":checked")) {
						user_id = this.value;
						id_checked.push(user_id);
					} else {
						user_id = this.value;
						index = id_checked.indexOf(user_id);
						id_checked.splice(index, 1);
					}
				});
				$("input[name='nameSelected']").attr('checked', 'checked');

			$("input[name='nameSelected']").change(function() {
								if ($("input[id='"+this.id+"']").is(":checked")) {
										user_id = this.id;
										name_checked.push(user_id);
									} else {
										user_id = this.id;
										index = id_checked.indexOf(user_id);
										name_checked.splice(index, 1);
									}
								});

			$('.input-daterange').datepicker({
				autoclose: true,
				todayHighlight: true
			});



			$('.confirm-delete').on('click', function(e) {
									e.preventDefault();

									var id = $(this).data('id');
									$('#deleteModal').data('id', id).data('name', all_names).data('attend_date', attend_date).modal('show');

								});

								$('#deleteModal').on('shown.bs.modal', function() {
									var id = $(this).data('id');
									var name = $('#deleteModal').data('name');
									var thisDate = $('#deleteModal').data('attend_date');
									$('#employee_name').html(name);
									$('#attend_date').html(thisDate);

								});



								$('#btnYes').click(function() {
									// handle deletion here
									var id = $('#deleteModal').data('id');
									console.log(id);

									<!--$('[data-id='+id+']').parents('tr').remove();-->
									var rowIndex = document.getElementById(id);
									<!--rowIndex.remove();-->
									rejectAttendance("{{ csrf_token }}", "{% url 'rejectAttendance' %}", id);

									$('#deleteModal').modal('hide');

								});

			$(".search").keyup(function () {

					var searchTerm = $(".search").val();
					var listItem = $('.results tbody').children('tr');
					var searchSplit = searchTerm.replace(/ /g, "'):containsi('")

				  $.extend($.expr[':'], {'containsi': function(elem, i, match, array){
						return (elem.textContent || elem.innerText || '').toLowerCase().indexOf((match[3] || "").toLowerCase()) >= 0;
					}
				  });

				  $(".results tbody tr").not(":containsi('" + searchSplit + "')").each(function(e){
					$(this).attr('visible','false');
				  });

				  $(".results tbody tr:containsi('" + searchSplit + "')").each(function(e){
					$(this).attr('visible','true');
				  });

				  var jobCount = $('.results tbody tr[visible="true"]').length;
					$('.counter').text(jobCount + ' item');

				  if(jobCount == '0') {$('.no-result').show();}
					else {$('.no-result').hide();}
			});

			});
			 var $table = $('#report_table'),
			$remove = $('#remove'),
			selections = [];
			function today() {
				var today = new Date();
				var dd = today.getDate();
				var mm = today.getMonth()+1; //January is 0!
				var yyyy = today.getFullYear();

				if(dd<10) {
					dd='0'+dd
				}

				if(mm<10) {
					mm='0'+mm
				}

				today = mm+'/'+dd+'/'+yyyy;
				return today;
			}
			function downloadCsv() {

				var start_date = document.getElementById("start").value;
				var end_date = document.getElementById("stop").value;
				if (start_date == "" || end_date == "") {
					start_date = today();
					end_date = today();
				}
				getCsv("{{ csrf_token }}", "{% url 'getCsv' %}", start_date, end_date, name_checked);
			}

			function downloadPdf() {

				var start_date = document.getElementById("start").value;
				var end_date = document.getElementById("stop").value;
				if (start_date == "" || end_date == "") {
					start_date = today();
					end_date = today();
				}
				getPdf("{{ csrf_token }}", "{% url 'timecard_pdf' %}");
			}

			function downloadExcel() {

				var start_date = document.getElementById("start").value;
				var end_date = document.getElementById("stop").value;
				if (start_date == "" || end_date == "") {
					start_date = today();
					end_date = today();
				}
				getExcel("{{ csrf_token }}", "{% url 'getCsv' %}", start_date, end_date, name_checked);
			}

			function tConvert (time) {
				if (time != null || time != undefined){

				var time = time.split(':');

				var hours = Number(time[0]);
				var minutes = Number(time[1]);
				var seconds = Number(time[2]);

				var timeValue = "" + ((hours >12) ? hours - 12 : hours);  // get hours
				timeValue += (minutes < 10) ? ":0" + minutes : ":" + minutes;  // get minutes
				timeValue += (hours >= 12) ? " P.M." : " A.M.";  // get AM/PM
			  	return timeValue; // return adjusted time or original string
			  	}
			}

			function downloadNewCsv() {

				var start_date = document.getElementById("start").value;
				var end_date = document.getElementById("stop").value;
				if (start_date == "" || end_date == "") {
					start_date = today();
					end_date = today();
				}
				getNewCsv("{{ csrf_token }}", "{% url 'getTempCsvFormat' %}", start_date, end_date, name_checked);
			}



			function getCsv(token, url, start, end, names){
				$.ajax({
				method : "POST",
				url : url,
				data : {"csrfmiddlewaretoken" : token, "start": start, "end":end, "namesChecked": names},
				datatype : "json",
				success : function(data, status, xhr) {
					var downloadLink = document.createElement("a");
					var blob = new Blob(["\ufeff", data]);
					var url = URL.createObjectURL(blob);
					downloadLink.href = url;
					var currentTime = new Date();
					downloadLink.download = "Timecards-"+currentTime+".csv";


					document.body.appendChild(downloadLink);
					downloadLink.click();
					document.body.removeChild(downloadLink);

				}
				});
			}



			function getExcel(token, url, start, end, names){
				$.ajax({
				method : "POST",
				url : url,
				data : {"csrfmiddlewaretoken" : token, "start": start, "end":end, "namesChecked":names},
				datatype : "blob",

				success : function(data, status, xhr) {

					var downloadLink = document.createElement("a");
					var blob = new Blob(["\ufeff", data]);
					var url = URL.createObjectURL(blob);
					downloadLink.href = url;
					var currentTime = new Date();
					downloadLink.download = "Timecards-"+currentTime+".xls";


					document.body.appendChild(downloadLink);
					downloadLink.click();
					document.body.removeChild(downloadLink);

				}
				});
			}

			function getNewCsv(token, url, start, end, name){
				$.ajax({
				method : "POST",
				url : url,
				data : {"csrfmiddlewaretoken" : token, "start": start, "end":end, "namesChecked":name},
				datatype : "json",
				success : function(data, status, xhr) {
					var downloadLink = document.createElement("a");
					var blob = new Blob(["\ufeff", data]);
					var url = URL.createObjectURL(blob);
					downloadLink.href = url;
					var currentTime = new Date();
					downloadLink.download = "Timecards-"+currentTime+".xls";


					document.body.appendChild(downloadLink);
					downloadLink.click();
					document.body.removeChild(downloadLink);

				}
				});
			}
			function goRight(){
				document.getElementById('goLeft').disabled = false;

				ids = id_checked;

					//need to only get the current id
					total = ids.length;
					correct_index += 1;

					getNextAttendanceInList(ids[correct_index]);
					current_step = correct_index+1;
					string_step = "("+current_step+"/"+total+")";
					$('#step').html(string_step);
					console.log(current_step);
					console.log(total);
					if(current_step == total){
						console.log(total);
						document.getElementById('goRight').disabled = true;
					}
			}

			function goLeft(){
				document.getElementById('goRight').disabled = false;

				ids = id_checked;

					//need to only get the current id
					total = ids.length;
					correct_index -= 1;

					getNextAttendanceInList(ids[correct_index]);
					current_step = correct_index+1;
					string_step = "("+current_step+"/"+total+")";
					$('#step').html(string_step);
					console.log(current_step);
					console.log(total);
					if(current_step == 1){
						console.log(total);
						document.getElementById('goLeft').disabled = true;
					}
			}


			function nextOrClose() {

				ids = id_checked;


				if(correct_index+1 >= ids.length){

					acceptAttendances("{{ csrf_token}}", "{% url 'acceptAttendances' %}", ids[correct_index]);
					updateAttendanceChanges("{{ csrf_token}}", "{% url 'updateAttendanceChanges' %}");
					$('#edit').modal('hide');

					correct_index = 0;
				}else {
					//need to only get the current id
					total = ids.length;


					current_step = correct_index+2;
					string_step = "("+current_step+"/"+total+")";
					$('#step').html(string_step);
					acceptAttendances("{{ csrf_token}}", "{% url 'acceptAttendances' %}", ids[correct_index]);
					updateAttendanceChanges("{{ csrf_token}}", "{% url 'updateAttendanceChanges' %}");
					correct_index += 1;

					getNextAttendanceInList(ids[correct_index]);



				}
			}

			function nextOrRejectorClose() {

				ids = id_checked;

				if(correct_index+1 >= ids.length){
					rejectAttendance("{{ csrf_token}}", "{% url 'rejectAttendance' %}", ids[correct_index]);
					$('#edit').modal('hide');

					correct_index = 0;
				}else {
					//need to only get the current id
					total = ids.length;

					current_step = correct_index+2;
					string_step = "("+current_step+"/"+total+")";
					$('#step').html(string_step);
					rejectAttendance("{{ csrf_token}}", "{% url 'rejectAttendance' %}", ids[correct_index]);
					correct_index += 1;
					getNextAttendanceInList(ids[correct_index]);

				}
			}

			function getIdSelections() {
				return $.map($table.bootstrapTable('getSelections'), function (row) {
					return row.id
				});
			}

			function updateAttendanceChanges(token, url){
				$.ajax({
				method : "POST",
				url : url,
				data : {"csrfmiddlewaretoken" : token, "shift_id": ids[correct_index], "new_shift_time": document.getElementById('clockin').value, "new_stop_time":document.getElementById('clockout').value},
				datatype : "json",
				success : function(data, status, xhr) {


				}
				});
			}


			function getPdf(token, url){
				$.ajax({
				method : "POST",
				url : url,
				data : {"csrfmiddlewaretoken" : token},
				datatype : "json",
				success : function(data, status, xhr) {


				}
				});
			}
			function updateReport(){
				var start_date = document.getElementById("start").value;
				var end_date = document.getElementById("stop").value;
				getReport("{{ csrf_token }}", "{% url 'timeKeeperDailyReport' %}", start_date, end_date, name_checked);
				id_checked = [];


			}

			$table.on('check.bs.table uncheck.bs.table ' +
                'check-all.bs.table uncheck-all.bs.table', function () {
            $remove.prop('disabled', !$table.bootstrapTable('getSelections').length);
            // save your data, here just save the current page
            selections = getIdSelections();
            // push or splice the selections if you want to save all data selections
        	});

        	$remove.click(function () {
            var ids = getIdSelections();
            $table.bootstrapTable('remove', {
                field: 'id',
                values: ids
            });
            $remove.prop('disabled', true);
        	});

        	function getAllEmployees(token, url) {
			$.ajax({
				method: "POST",
				url: url,
				data: {"csrfmiddlewaretoken": token },
				datatype: "json",

				success: function(data, status, xhr){
						for(var i = 0; i < data.employees.length; i++){
							first_name = data.employees[i].first_name.toString();
							last_name = data.employees[i].last_name.toString();
							employee_name = first_name + " " + last_name;

							$("#items").append('<li style="font-size: 18px; z-index:200; position:relative;margin-top: 20px; margin-left:10px;" ><input style="float: left;" name="nameSelected" id="'+data.employees[i].qr_code+'"  type="checkbox" />'+data.employees[i].first_name + ' '+ data.employees[i].last_name+'</li>');

						}

						var checkList = document.getElementById('list1');
						var items = document.getElementById('items');
						checkList.getElementsByClassName('anchor')[0].onclick = function (evt) {
							if (items.classList.contains('visible')){
								items.classList.remove('visible');
								items.style.display = "none";
							}

							else{
								items.classList.add('visible');
								items.style.display = "block";
							}


						}

						items.onblur = function(evt) {
							items.classList.remove('visible');
						}

						$("input[name='nameSelected']").change(function() {

								if ($("input[id='"+this.id+"']").is(":checked")) {
										user_id = this.id;
										name_checked.push(user_id);
									} else {
										user_id = this.id;
										index = name_checked.indexOf(user_id);
										name_checked.splice(index, 1);
									}
								});


				}
			});
		}
			function acceptAttendances(token, url, attendances) {
				$.ajax({
				method : "POST",
				url : url,
				data : {"csrfmiddlewaretoken" : token, "attendances": attendances},
				datatype : "json",
				success : function(data, status, xhr) {
					$("#status"+attendances).html('<span style="font-size: 15px;color:blue;" class="glyphicon glyphicon-ok">');

					document.getElementById(attendances).style.backgroundColor = "white";
				}
				});
			}

			function rejectAttendance(token, url, attendance) {
				$.ajax({
				method : "POST",
				url : url,
				data : {"csrfmiddlewaretoken" : token, "attendance": attendance},
				datatype : "json",
				success : function(data, status, xhr) {
					console.log(attendance);
					$("#status"+attendance).html('<span style="font-size: 15px;color:red;" class="glyphicon glyphicon-remove">');
					document.getElementById(attendance).style.backgroundColor = "white";
				}
				});
			}

			function getNextAttendanceInList(attend_id){
				getNextAttendance("{{ csrf_token }}", "{% url 'getNextAttendance' %}", attend_id);

			}

			function getNextAttendance(token, url, attendanceid) {
				$.ajax({
				method : "POST",
				url : url,
				data : {"csrfmiddlewaretoken" : token, "attendanceid": attendanceid},
				datatype : "json",
				success : function(data, status, xhr) {
					$('#allBreaks').html('');
					$('#attend_name').html(data.attend_name);
					$('#attend_date_modal').html(data.attend_date);

					breaks = JSON.parse(data.breaks);

					attendance = JSON.parse(data.attendances);

					parsed_result = $.parseJSON(data.breaks);
					parsed_attend = $.parseJSON(data.attendances);
					$(function () {
						var i = 1;
						var breaks = 1;
						var lunch = 1;
						$.each(parsed_attend, function (i, item) {
							document.getElementById('clockin').value = item.fields.hour_started;
							document.getElementById('clockout').value = item.fields.hour_ended;

						});
					});

					$(function () {
						var i = 1;
						var breaks = 1;
						var lunch = 1;
						$.each(parsed_result, function (i, item) {

							if(item.fields.lunch == true){
								$('#allBreaks').append('<label>Lunch'+lunch+'</label>');
								$('#allBreaks').append('<div class="form-group"><label >Start:</label><input class="form-control" type="time" value="'+ item.fields.start +'"><label >Stop:</label><input class="form-control" type="time" value="'+item.fields.end+'"></div>');
								lunch += 1;
							}else {
								$('#allBreaks').append('<label>Break'+breaks+'</label>');
								$('#allBreaks').append('<div class="form-group"><label >Start:</label><input class="form-control" type="time" value="'+ item.fields.start +'"><label>Stop:</label><input class="form-control" type="time" value="'+ item.fields.end +'"></div>');

								breaks += 1;
							}
						});

					});
					$('#modalFooter').html('<button type="button" id="update" onclick="nextOrClose()" class="btn btn-success btn-lg" style="width: 100%;"><span class="glyphicon glyphicon-ok-sign"></span> Approve</button>');
					$('#modalFooter').append('<button type="button" id="reject" onclick="nextOrRejectorClose()" class="btn btn-danger btn-lg" style="width: 100%;margin-top: 20px;margin-left:0px;"><span class="glyphicon glyphicon-remove-sign"></span> Reject</button>');
				}
				});
			}



			function getReport(token, url, start, end, names) {
			$.ajax({
				method : "POST",
				url : url,
				data : {"csrfmiddlewaretoken" : token, "start": start, "end":end, "namesChecked": names},
				datatype : "json",
				success : function(data, status, xhr) {
					if (data) {
						$('#results').html("");
						parsed_result = $.parseJSON(data.all_attendances);

						$(function () {
							var i = 1;
							$.each(parsed_result, function (i, item) {

								var start_hour = tConvert(item.fields.hour_started);
								var end_hour = tConvert(item.fields.hour_ended);
								var total_time = data.total_times[i];
								var attend_id = data.attend_ids[i];

								var attend_action_id = "action" + data.attend_ids[i];
								var jobs = data.job_codes[i];
								var locations = data.ranches[i];
								var all_names = data.all_names[i];
								var attend_date = item.fields.date;
								var id_date = all_names + ": " + attend_date;

								if(jobs == ""){
									jobs = "--";
								}

								if(locations == ""){
									locations = "--";
								}

								if(! start_hour){
									start_hour = 'N/A';
								}

								if(! end_hour){
									end_hour = 'N/A';
								}

								if(item.fields.hour_ended < item.fields.hour_started) {
									total_time = 'N/A';
								}

								if(end_hour == 'N/A' || start_hour == 'N/A'){
									total_time = 'N/A';
								}

								var demo = "demo" + i;
								$('#results').append('<tr id="'+attend_id+'"  class="accordion-toggle"><td><input id="'+attend_id+'" name="rowSelected" type="checkbox" class="checkthis" /></td> <td data-toggle="collapse" data-target=#'+demo+'>' +
								data.qr_code[i] + '</td><td data-toggle="collapse" data-target=#'+demo+'>' + all_names + '</td><td data-toggle="collapse" data-target=#'+demo+'>' + attend_date +'</td><td data-toggle="collapse" data-target=#'+demo+' data-editable="true">' +
								start_hour + '</td><td data-toggle="collapse" data-target=#'+demo+' data-editable="true">' + end_hour + '</td><td data-toggle="collapse" data-target=#'+demo+'>' + total_time+'</td><td id="status'+attend_id+'"></td></tr>');
								$('#results').append('<tr><td colspan="12" class="hiddenRow"><div class="accordian-body collapse" id='+demo+'> <table class="table table-striped"><thead><tr><th>Job Codes</th><th>Locations</th><th># Breaks </th><th> Total Break Time</th><th># Lunches</th><th> Total Lunch Time</th></tr></thead><tbody><tr><td>' + jobs +'</td><td>' + locations +'</td><td>' + data.num_breaks[i] +'</td><td>' + data.total_break_time[i] +'</td><td>' + data.num_lunches[i] +'</td><td>' + data.total_lunch_time[i] +'</td><td><a href="#" class="confirm-delete btn mini red-stripe" style="color: red;" role="button" data-title="'+id_date+'" data-id="'+attend_id+'">Reject</a></td></tr></tbody></table></div> </td></tr>');
								if(data.managerAccepts[i] == false){
									if(data.managerRejects[i] == true){
										<!--row = document.getElementById(attend_id);-->
										<!--row.style.backgroundColor = "#F7A6A4";-->
										$("#status"+attend_id).html('<span style="font-size: 15px;color:red;" class="glyphicon glyphicon-remove">');

									}else {
										if(data.declines[i] == true){
											row = document.getElementById(attend_id);
											row.style.backgroundColor = "red";
										}else{
											row = document.getElementById(attend_id);
											row.style.backgroundColor = "#F3F3F3";
										}
									}
								} else {
									<!--row = document.getElementById(attend_id);-->
									<!--row.style.backgroundColor = "#E4E4E4";-->
									$("#status"+attend_id).html('<span style="font-size: 15px;color:blue;" class="glyphicon glyphicon-ok">');
								}
								$('.confirm-delete').on('click', function(e) {
									e.preventDefault();

									var id = $(this).data('id');
									var name = $(this).data('title');
									$('#deleteModal').data('id', id).data('name', name).modal('show');

								});


								$('#deleteModal').on('shown.bs.modal', function() {
									var id = $(this).data('id');
									var name = $('#deleteModal').data('name');
									var thisDate = $('#deleteModal').data('attend_date');
									$('#employee_name').html(name);
									$('#attend_date').html(thisDate);

								});


								$('#btnYes').click(function() {
									// handle deletion here
									var id = $('#deleteModal').data('id');

									<!--$('[data-id='+id+']').parents('tr').remove();-->
									var rowIndex = document.getElementById(id);
									<!--rowIndex.remove();-->
									rejectAttendance("{{ csrf_token }}", "{% url 'rejectAttendance' %}", id);

									$('#deleteModal').modal('hide');

								});




								i = i+1;

							});
						});

						$("input[name='rowSelected']").change(function() {


								if ($("input[id='"+this.id+"']").is(":checked")) {
										user_id = this.id;
										id_checked.push(user_id);
									} else {
										user_id = this.id;
										index = id_checked.indexOf(user_id);
										id_checked.splice(index, 1);
									}

									if(id_checked.length == 0){
									document.getElementById("remove").disabled = true;
								} else {
									document.getElementById("remove").disabled = false;
								}
								});


					}
				}
			});
		}

		</script>
	</head>
	<body>

		<header id="head"></header>
			<div id="wrapper">
				<div id="content">
					<div class="namePage">

					</div>
					<div id="report" style="margin: 10px; margin-top: 60px;">
					<!--<div class="col-lg-6">-->
					<div class="panel panel-default">
					<div class="panel-heading"><h3><img src="{% static 'imgSmall/iconTimekeeper.png' %}"/>
						{% trans 'HC TIMEKEEPER REPORT' %}</h3>
					</div>
					<div class="panel-body">
						<div align="left" style="font-weight:600;font-size:18px;">Select Dates:</div>
					<div style="width: 70%;float: left;" class="input-daterange input-group" id="datepicker">
						<input type="text" id="start" class="input-sm form-control" name="start" />
						<span class="input-group-addon">to</span>
						<input type="text" id="stop" class="input-sm form-control" name="end" />

					</div>
					<div style="width: 30%;float: right;" id="list1" style="margin-top: 30px;" class="dropdown-check-list" tabindex="100">
						<span style="margin-left:10px;width: 100%;border-radius: 4px; font-size: 18px;font-weight: 600;" class="anchor">Select Employees</span>
						<ul style="border-radius: 4px;position:absolute; background: white;width: 100%;float:center;" id="items" class="items">
						</ul>
					</div>

				<script type="text/javascript">

				var checkList = document.getElementById('list1');
				var items = document.getElementById('items');
						checkList.getElementsByClassName('anchor')[0].onclick = function (evt) {
							if (items.classList.contains('visible')){
								items.classList.remove('visible');
								items.style.display = "none";
							}

							else{
								items.classList.add('visible');
								items.style.display = "block";
							}


						}

						items.onblur = function(evt) {
							items.classList.remove('visible');
						}
				</script>

						<!--<div class="form-group pull-right"><input type="text" class="search form-control " placeholder="Search"/>-->
					<button style="float: right;margin-top: 15px; margin-left:60%;margin-bottom:10px;height:50px;font-size:15px;font-weight:600;background-color: #6DA8F5;" type="button" class="btn btn-default" onclick="updateReport()" >Update Report</button>
					<button id="remove" data-title="Edit" data-toggle="modal" data-target="#edit" style="float:left; margin-top:30px; margin-bottom: 15px;" class="btn btn-warning" disabled>
							<i class="glyphicon glyphicon-ok-sign"></i> Review Attendance(s)
						</button>

					<table class="table table-condensed results table-bordered" id="report_table" style="border-collapse:collapse;">

						<thead>
							<tr>
								<th><input type="checkbox" id="checkall" /></th>
								<th>ID</th>
								<th>Name</th>
								<!--<th>Team Lead</th>-->
								<!--<th>Team Name</th>-->
								<!--<th>Location</th>-->
								<!--<th>Job Code</th>-->
								<!--<th>Location</th>-->
								<th>Date</th>
								<th>Clock-In</th>
								<th>Clock-Out</th>
								<th>Hours Worked(w/ breaks)</th>
								<th ><a href="#" id="status" class="white-tooltip" data-toggle="tooltip" data-html="true" title="<p><span style='font-size: 15px;color:blue;' class='glyphicon glyphicon-ok'> Approved</p><p><span style='font-size: 15px;color:red;' class='glyphicon glyphicon-remove'> Rejected</p> ">Status   <i style="font-size:18px" class="glyphicon glyphicon-info-sign"></i></a></th>
							</tr>
						</thead>
						<tbody id="results">
						</tbody>
					</table>
            		</div>

          </div>

      <!--</div>-->
						</div>

				</div>

				<button has-spinner style="float: right;margin-right: 15px;height: 50px; font-weight: 600;font-size: 15px;" type="button" onclick="downloadExcel()" class="btn btn-default" ><span class="spinner"><i class="icon-spin icon-refresh"></i></span>Download .xls</button>
				<button style="float: right;margin-right: 15px;height: 50px; font-weight: 600;font-size: 15px;" type="button" class="btn btn-success" id="btnExport" onclick="downloadCsv()"><span style="font-size: 15px;" class="glyphicon glyphicon-download"></span>Download .csv</button>
				<!--<a href="{% url 'timecard_pdf' %}"><button style="float: right;margin-right: 15px;height: 50px; font-weight: 600;font-size: 15px;" type="button" class="btn btn-success" id="btnExportPdf"><span style="font-size: 15px;" class="glyphicon glyphicon-download"></span>Download .pdf</button></a>-->
				<button style="float: right;margin-right: 15px;height: 50px; font-weight: 600;font-size: 15px;" type="button" class="btn btn-success" id="btnExport2" onclick="downloadNewCsv()"><span style="font-size: 15px;" class="glyphicon glyphicon-download"></span>Download WEEKLY formatted .xls</button>


			</div>
		<footer style="margin-top:60px" id="foot"></footer>
	<div id="deleteModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                        <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">Are you sure you want to delete:</h4>
            </div>

            <div class="modal-body">
                <p style="font-weight:600;font-size:24px;" id="employee_name"></p>
                <p style="font-size:20px;" id="attend_date"></p>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <a id="btnYes" class="btn btn-danger btn-ok">REJECT</a>
            </div>
        </div>
    </div>
   </div>

	<div class="modal fade" id="edit" tabindex="-1" role="dialog" aria-labelledby="edit" aria-hidden="true">
      <div class="modal-dialog">
    <div class="modal-content">
          <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>
        <h4 class="modal-title custom_align" id="Heading">Edit Timecard <span id="step"></span></h4>
      </div>
          <div class="modal-body">
			  <div style="margin-bottom:30px;">
			  <button id="goLeft" onclick="goLeft()" type="button" style="float:left;" class="left close" aria-hidden="true" disabled="true">
						  <i class="glyphicon glyphicon-chevron-left" aria-hidden="true"></i>
			  </button>
			  <button id="goRight" onclick="goRight()" type="button" style="float:right;" class="close" aria-hidden="true"><i class="glyphicon glyphicon-chevron-right" aria-hidden="true"></i></button>
				</div>
			  <div class="form-group ">
				  <p>
				  <label>Name:</label>
				  <span id="attend_name">Name:</span>
				  <label>Date:</label>
				  <span id="attend_date_modal">Date:</span>
				  </p>
					<label for="clockin">Clock-in:</label>
					<input id="clockin" class="form-control" type="time" placeholder="">
					<label for="clockout">Clock-out:</label>
					<input id="clockout"  class="form-control" type="time" placeholder="">
			  </div>
			  <div id="allBreaks"></div>
      </div>
          <div id="modalFooter" class="modal-footer">
      </div>
        </div>
    <!-- /.modal-content -->
  </div>
      <!-- /.modal-dialog -->
    </div>
	</body>

</html>