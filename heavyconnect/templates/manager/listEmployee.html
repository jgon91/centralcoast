<!DOCTYPE html>
<html lang="en">
	<head>
		{% load staticfiles %}
		{% load i18n %}
		<link rel="stylesheet" type="text/css" href="{% static 'css/equipStyle.css' %}">
		<link rel="stylesheet" type="text/css" href="{% static 'css/styleManager.css' %}">
		<script src="{% static 'js/jquery-1.11.2.min.js' %}"></script>
		<script src="http://maps.google.com/maps/api/js?sensor=false"></script>
		<script src="{% static 'js/script.js' %}"></script>
		<script>
			$(document).ready(function() {
				$("#foot").load("{% url 'footer' %}");
				$("#head").load("{% url 'headerManager' %}");

				getAllEmployees("{{ csrf_token }}", "{% url 'getAllEmployees' %}");
			});

			function getAllEmployees(token, url) {
				
					$.ajax({
						method: "POST",
						url: url,
						data: {"csrfmiddlewaretoken": token },
						datatype: "json",
						success: function(data, status, xhr){							
							console.log(data);
							for(var i = 0; i < data.employees.length; i++){
								$(".listEmployee").append("<tr><td>" + data.employees[i].first_name + " " + data.employees[i].last_name + "</td><td><a class='editEmployee' id='"+ data.employees[i].user_id +"' > Edit </a></td></tr>");
							}

							$(".editEmployee").click( function(){ 
								editEmployee(token, this.id);
							});
							
						}
					});			
			}

			function editEmployee(token, id) {
				
					$.ajax({
						method: "POST",
						url: "{% url 'employeeManagerUpdateForm' %}",
						data: {"csrfmiddlewaretoken": token, "user_id": id, "controler": true },
						datatype: "json",
						success: function(data, status, xhr){							
							console.log('sucess');
						}
					});			
			}



		</script>
		
	</head>
	<body>
		<header id="head"></header>
			<br><br>
			<div style="text-align: center;">
				<table class="listEmployee" id="tableManageForm">
					
				</table>
			</div>
		<footer id="foot"></footer>
	</body>
</html>